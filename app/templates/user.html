{% extends "layout.html" %}
{% block content %}

<div style="display:flex; flex-direction:column; align-items:center; justify-content:center; margin-top:40px;">

    <!-- Profile Picture -->
    <div style="position:relative; text-align:center;">
        <form id="profile-pic-form" action="{{ url_for('main.profile') }}" method="POST" enctype="multipart/form-data">
            <label for="profile-pic-input" style="cursor:pointer;">
                <img src="{{ current_user.profile_pic or url_for('static', filename='default_user.png') }}"
                     alt="Profile Picture"
                     style="width:150px; height:150px; border-radius:50%; border:3px solid #007BFF; object-fit:cover;">
            </label>
            <input type="file" id="profile-pic-input" name="profile_pic" accept="image/*"
                   style="display:none;" onchange="document.getElementById('profile-pic-form').submit();">
        </form>
        <p style="color:#666; font-size:0.9em;">Click the image to change your picture</p>
    </div>

    <!-- Username -->
    <h2 style="margin:10px 0 0 0;">{{ current_user.username }}</h2>

    <!-- Email -->
    <p style="color:#555; margin:5px 0 20px 0;">
        <strong>Email:</strong> {{ current_user.email }}
    </p>

    <!-- Tabs -->
    <div style="width:80%; max-width:600px; text-align:center;">
        <div style="display:flex; justify-content:space-around; border-bottom:2px solid #007BFF;">
            <button class="tab-button active" onclick="showTab('posts')" style="flex:1; padding:10px; background:none; border:none; font-weight:bold; cursor:pointer; color:#007BFF;">Posts</button>
            <button class="tab-button" onclick="showTab('comments')" style="flex:1; padding:10px; background:none; border:none; font-weight:bold; cursor:pointer; color:#007BFF;">Comments</button>
            <button class="tab-button" onclick="showTab('likes')" style="flex:1; padding:10px; background:none; border:none; font-weight:bold; cursor:pointer; color:#007BFF;">Likes</button>
        </div>

        <!-- Content Areas -->
        <div id="posts" class="tab-content" style="margin-top:20px;">
            {% if user_posts %}
                {% for post in user_posts %}
                    <div style="background:#f9f9f9; border-radius:8px; padding:10px; margin-bottom:10px; text-align:left;">
                        <p>{{ post.content }}</p>
                        <small style="color:#777;">{{ post.date_posted }}</small>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color:#777;">No posts yet.</p>
            {% endif %}
        </div>

        <div id="comments" class="tab-content" style="display:none; margin-top:20px;">
            {% if user_comments %}
                {% for comment in user_comments %}
                    <div style="background:#f9f9f9; border-radius:8px; padding:10px; margin-bottom:10px; text-align:left;">
                        <p><strong>On:</strong> {{ comment.post_title }}</p>
                        <p>{{ comment.content }}</p>
                        <small style="color:#777;">{{ comment.date_posted }}</small>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color:#777;">No comments yet.</p>
            {% endif %}
        </div>

        <div id="likes" class="tab-content" style="display:none; margin-top:20px;">
            {% if user_likes %}
                {% for like in user_likes %}
                    <div style="background:#f9f9f9; border-radius:8px; padding:10px; margin-bottom:10px; text-align:left;">
                        <p>❤️ Liked: <strong>{{ like.post_title }}</strong></p>
                        <small style="color:#777;">{{ like.date_liked }}</small>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color:#777;">No likes yet.</p>
            {% endif %}
        </div>
    </div>
</div>

<script>
function showTab(tabName) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
    // Remove active state from all buttons
    document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
    // Show the selected tab and highlight its button
    document.getElementById(tabName).style.display = 'block';
    event.target.classList.add('active');
}
</script>

{% endblock %}
